## 目标
- 将“搜索→打开首篇→打印内容”变成默认自动流程，无需你逐步设置选择器或逐步点击按钮。
- 你只控制关键节点（开始/暂停/继续/重试/跳过阶段/修改关键词），其余选择器与动作由系统自动决定与重试。

## 流程编排（默认）
1. 初始化会话与浮窗（Playwright 持久化）
2. 搜索阶段
   - 自动聚焦搜索框（默认选择器集合逐项尝试）
   - 自动逐字符输入关键词（带节奏）
   - 自动提交搜索（优先点击按钮，失败兜底 Enter）
3. 列表阶段
   - 等待结果列表可见（默认集合逐项尝试）
   - 选择第一条可见候选（过滤已访问）
4. 打开详情
   - 鼠标坐标点击中心点进入详情（失败回退 DOM click）
   - 受限页检测：命中则自动回退并选择下一候选 [循环]
5. 内容打印
   - 提取 `{ id, url, title, author, text, images, videos }`，打印到控制台与浮窗

## 选择器与失败重试（系统决定）
- 选择器来源：`src/autoop/selectors.js` 的默认集合；系统自动按集合逐项尝试与可见性校验
- 动作失败时重试策略：
  - 搜索点击失败：强制焦点在输入框后发送 Enter
  - 列表选择失败：轻微滚动、再次检测；仍失败则切下一候选集合
  - 打开详情失败：换点击方式（坐标→DOM click），并重试一次
- 只有当默认集合全部失败时，浮窗才会显示结构化诊断（阶段、动作、原因、默认候选与匹配数量），供你选择是否覆盖；若不覆盖，系统继续下一候选或下一步重试。

## 最小控制节点（浮窗）
- 开始流程：一键运行整条默认流程
- 暂停/继续：切换自动推进
- 重试当前阶段：在失败或暂停时一键重试当前阶段（仍用默认集合）
- 跳过阶段：直接进入下一阶段（如跳过搜索直接按现列表打开首条）
- 修改关键词：仅修改关键词后重新执行搜索阶段；其余由系统自动完成

## 日志与可视化
- 浮窗显示当前阶段与动作、已使用的选择器（若来自默认集合则标注“默认”）
- 失败时显示诊断；成功时显示“已使用默认选择器: <selector>”与匹配数量
- 控制台输出 `[pw-step]` 与最终 `[NOTE]` 对象

## 稳定性与兜底
- 导航/SPA 切换：监听并自动重注入绑定，保证浮窗按钮始终有效
- 忙锁与排队：点击“下一步/重试”在忙时排队并在当前步结束后执行
- 指纹与节奏：保持键盘延迟与鼠标事件链的真实性

## 你的操作方式（简洁）
- 启动：`npm run pw:open -- --plat xhs`
- 浮窗：填关键词 → 点击“开始流程”；如需暂停/继续/重试/跳过，使用对应按钮即可
- 只有在默认确实失败时，按浮窗诊断决定是否覆盖选择器；否则无需手动干预

## 交付内容
- Runner 增强：默认集合逐项尝试与可见性校验、失败重试、受限回退与循环、最终打印
- Overlay 增强：最小控制节点按钮与进度显示、失败诊断仅在必要时出现
- 绑定增强：导航重注入与命令排队

确认后我直接按此方案实现，让流程默认自动跑，你只在关键节点控制或在必要时覆盖选择器。