## 现状与差异
- 自动运营：Electron→Python 运行时设置 `USER_DATA_DIR`，Python `load_config` 读取并覆盖 `browser.user_data_dir`，`BrowserService.start()` 用持久化上下文 + `ensure_login()` 持久化登录态。
- 单元测试：直接解析 `config.yaml` 的 `browser.user_data_dir`，不读取 `USER_DATA_DIR` 环境覆盖，也未执行入口导航的登录校验，导致与应用不一致（目录或流程不同）。

## 目标
- 单元测试与自动运营复用同一登录目录与流程，自动读取有效目录，不依赖手动设置。

## 代码改动
1) tests 基类优先读取环境覆盖
- 在 `tests/base_login.py` 的 `user_data_dir()`：优先读取 `os.getenv('USER_DATA_DIR')`；若无，再解析 `auto_opration_python/config/config.yaml` 的 `browser.user_data_dir`（相对路径转绝对）；若仍无，回退 `~/.autoOperation`。

2) 测试前置登录校验与对齐流程
- 在每个测试用例：
  - 启动 `chromium.launch_persistent_context(user_data_dir(), headless=False)`。
  - 先打开 `https://www.xiaohongshu.com`，读取 `ctx.storage_state()`，断言含 `xiaohongshu.com` cookies；否则明确失败提示缺失登录态。
  - 再进入目标详情页，执行点赞/收藏/评论点击（保持随机 1–2 秒间隔）。

3) 可选：统一读取有效配置并模拟应用流程
- 新增 `tests/helpers.py`：
  - 复用 Python `load_config()`，让环境覆盖（`USER_DATA_DIR`）生效；
  - 提供 `ensure_login_like_app()`：打开入口、等待 cookie 增长或选择器出现，必要时保存 `storage_state`；测试调用此方法对齐应用登录流程。

## 运行方式
- 不用手工改配置或传参：应用主进程已设置 `USER_DATA_DIR`；测试基类会自动读取同一值。
- 直接运行：`playwright install chromium` → `python -m unittest auto_opration_python/tests/test_like_collect_click.py`

## 验证
- 在应用中登录一次后运行单测：应通过登录态断言，随后点赞/收藏点击成功；若登录态缺失，单测会明确报错并提示先登录。