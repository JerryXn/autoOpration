## 目标
- 在“飞书公开链接”输入框下方嵌入内置浏览器（webview），加载用户粘贴的公开链接。
- 用户可在该内置浏览器中登录/跳转；页面加载完成后在内置浏览器上下文解析多维表格并填充到预览与发布列表。
- 保留现有无头抓取作为兜底（若 webview 失败时）。

## 技术方案
- Electron 内置浏览器：使用 `<webview>` 标签（需在主进程 BrowserWindow 开启 `webviewTag: true`）。
- 解析方式：当 webview `did-finish-load` 触发后，使用 `webview.executeJavaScript` 在页面上下文获取 DOM 表格结构，抽取表头与数据行。
- 登录/权限：若链接需要登录，用户可在内置浏览器中登录；解析逻辑在加载完成后重试。

## 主进程改动
- `createHomeWindow` 增加：`webviewTag: true`（保留 `contextIsolation: true`, `nodeIntegration: false`, `sandbox: true`）。
- 保留现有 `feishu-fetch` IPC 作为备用方案，无需删除。

## 前端页面改造
- 在“素材导入→通过飞书公开链接”区域下新增 webview 容器：
  - DOM：`<webview id="feishu-webview" style="width:100%; height:380px; border:1px solid #f0f0f0; border-radius:8px" allowpopups></webview>`。
  - 输入框回车后：设置 `webview.src = 链接`，显示 webview。
- 事件绑定：
  - `did-finish-load`：执行解析脚本（见“解析逻辑”）。
  - `did-fail-load`：提示用户加载失败；可切换到无头抓取兜底。
  - 在页面跳转（`did-navigate`/`did-frame-finish-load`）时也尝试解析。

## 解析逻辑（在 webview 页面上下文）
- 目标：抽取表头（`th`）与数据行（`tr/td`），输出为数组对象。
- 步骤：
  1. `const table = document.querySelector('table') || document.querySelectorAll('table')[0];`
  2. 取表头：`Array.from(table.querySelectorAll('thead th')).map(el=>el.textContent.trim())`，若没有 `thead`，取首行 `tr`。
  3. 取数据：遍历 `tbody tr` 或所有 `tr` 去除头部，逐行 `Array.from(tr.querySelectorAll('td')).map(el=>el.textContent.trim())`。
  4. 映射字段：根据中文列名或英文列名的兼容（标题/文案/封面/配图 → title/content/cover/images）。
  5. 返回 `{ header, rows }` 给渲染进程；渲染进程做行对象化并更新预览表格。
- 登录判断：若页面包含登录提示关键字（如 `passport_web_did`），则先提示用户登录，登录后自动再次尝试解析。

## 前端集成
- 在 `src/views/autopublish.js`：
  - 为飞书输入框 `Enter` 事件：`feishuWebview.src = url;` 并清空提示。
  - 绑定 webview 事件：在 `did-finish-load` 中调用 `executeJavaScript` 获取 `{header, rows}` 并转换为 `{ title, content, cover, images }`，然后调用现有 `rebuild()` 更新预览。
  - 失败兜底：若 webview 解析失败，调用现有 `services.ipc.fetchFeishu(url)` 作无头抓取。

## 体验与交互
- 用户粘贴公开链接并回车后，webview 下方显示加载中的页面；加载完成后自动解析并填充预览。
- 若用户需登录，直接在 webview 中完成登录；解析在登录后页面加载完成再尝试。

## 安全与兼容
- webview 启用 `allowpopups` 以应对登录弹窗；仍保持 `nodeIntegration: false`，在页面中不启用 Node。
- 解析脚本仅访问页面 DOM，不注入远程脚本；对多表格页面选取第一个表格为初始策略。

## 验证
- 用公开链接测试：能加载并正确解析表头与数据。
- 用需登录链接测试：在 webview 中登录后成功解析。
- 解析出的列名兼容中文/英文；封面/配图字段能在预览正确显示。

请确认：
- webview 可见高度 380px 是否合适？是否需要“展开/折叠”按钮来调整高度？
- 若页面存在多个表格，默认解析第一个是否满足？需要提供下拉选择具体表格吗？