## 目标
- 在“自动运营”界面新增可配置搜索参数：类型（图文/视频）、排序（综合/最新/最多点赞/最多评论/最多收藏）、发布时间（不限/一天内/一周内/半年内）、搜索范围（不限/已看过/未看过/已关注）、位置距离（不限/同城/附近）。
- 将所选参数通过 IPC 透传到后端，并在真正调用 `https://edith.xiaohongshu.com/api/sns/web/v1/search/notes` 时按你给出的 curl 结构严格体现在请求体中。

## 参数映射
- note_type：图文=2，视频=1
- filters.sort_type.tags：
  - 综合 → ["general"]
  - 最新 → ["time_descending"]
  - 最多点赞 → ["popularity_descending"]
  - 最多评论 → ["comment_descending"]
  - 最多收藏 → ["collect_descending"]
- filters.filter_note_time.tags：不限/一天内/一周内/半年内 → 使用中文标签
- filters.filter_note_range.tags：不限/已看过/未看过/已关注 → 使用中文标签
- filters.filter_pos_distance.tags：不限/同城/附近 → 使用中文标签
- 共同字段：sort:"general"、ext_flags:[]、geo（会话定位）、image_formats:["jpg","webp","avif"]、search_id（透传或生成）

## 前端界面改造
- 在“自动运营”页面新增搜索表单：
  - 关键词输入框
  - 类型单选：图文/视频（默认图文）
  - 排序单选：综合/最新/最多点赞/最多评论/最多收藏（默认综合）
  - 发布时间单选：不限/一天内/一周内/半年内（默认不限）
  - 搜索范围单选：不限/已看过/未看过/已关注（默认不限）
  - 位置距离单选：不限/同城/附近（默认不限）
  - 搜索/重置按钮
- 点击“搜索”后，通过 IPC 发送：
  - `{ keyword, filters: { noteType, sortBy, publishTime, scope, distance } }`

## 后端 Node 透传
- 在主进程接收 IPC 的 `start-auto-op`，将 `filters` 原样透传至 Python（命令行参数或环境变量 JSON），关键词也透传。
- 日志打印前端选择（打码敏感值），便于追踪参数是否正确到达后端。

## Python 侧集成
- 新增构造函数 `build_search_body(keyword, page, page_size, filters, geo)`：
  - 生成与你的 curl 一致的 JSON：顶层含 `keyword/page/page_size/search_id/sort/note_type/ext_flags/filters/geo/image_formats`
  - `filters` 数组包含：`{type:'sort_type',tags:[...]}`、`{type:'filter_note_time',tags:[...]}`、`{type:'filter_note_range',tags:[...]}`、`{type:'filter_pos_distance',tags:[...]}`
- 新增 `search_notes_with_body(body, timeout)`：使用已有模板的 `url/headers/cookie` 发起请求，传入构造好的 `body`
- 在 `main_xhs.py`：
  - 读取透传的 `filters` 与 `keyword`
  - 如果有会话定位则填充 `geo`，否则留空或使用默认
  - 调用 `search_notes_with_body` → 解析 JSON（沿用 `parse_search_result/parse_notes`）
  - 继续详情页抓取与媒体/标签入库（现有逻辑）

## 日志与验证
- 前端：展示所选参数；后端：中文结构化日志输出 `[操作] 已应用筛选`（显示 note_type 与各 tags）、`[远程调用] 搜索 响应`（状态/条数）
- 验证用例：
  - 图文/视频切换验证 `note_type`
  - 综合/最新/最多点赞/最多评论/最多收藏验证 `sort_type`
  - 不限/一天内/一周内/半年内验证 `filter_note_time`
  - 不限/已看过/未看过/已关注验证 `filter_note_range`
  - 不限/同城/附近验证 `filter_pos_distance`

## 默认与回退
- 默认“图片为筛选”→类型=图文；排序=综合；时间/范围/距离=不限
- 页面筛选点击与接口调用双路径：优先接口驱动；页面结构变更时回退到 UI 点击并监听 `/search/notes` 响应