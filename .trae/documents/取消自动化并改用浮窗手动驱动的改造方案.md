## 目标
- 彻底取消现有自动化，所有页面动作仅在你点击浮窗“下一步”时执行一个最小粒度动作。
- 浮窗保持在最上层，可拖拽与记忆位置，显示下一步计划与选择器，可编辑并应用。

## 改造范围
- 主进程：`src/main.js`
- 预加载：`src/preload.js`
- 渲染层：`src/views/autoop.js`
- 样式与容器（已具备）：`src/index.html`、`src/styles/app.css`

## 主进程改造（队列驱动）
- 移除自动化循环与所有自动输入/点击/滚动逻辑，仅保留基础方法与日志/现场采集。
- 新增运行态与队列：`{ win, step, queue, pointer, busy, selectors, visited }`。
- 仅在收到 `autoop-next` 时执行队列中一个“微动作”，完成后 `pointer++` 并发送计划预览；`autoop-retry` 重做当前；`autoop-error` 采集现场（URL/HTML片段）。

## 微动作定义（最小粒度）
- `query_selector(stageSel)`：解析元素并产出坐标，受你在浮窗应用的选择器覆盖（`window.__userSel_<stage>`）。
- `move_to(x,y)`：鼠标移动到坐标（轻微抖动）。
- `hover(ms)`：悬停等待。
- `mouse_down(button)` / `mouse_up(button)`：按下/抬起指定按钮。
- `click(button)`：组合 `down+短等待+up`。
- `scroll_by(target, dy)`：滚动容器或窗口指定像素。
- `char_input(ch)`：单字符输入（每个字符一个“下一步”）。
- `program_click(selector)`：程序化触发 click（降级路径）。
- `wait(ms)`：等待加载/动画。

## 阶段与队列示例
- `search_focus`: [query_selector(input), move_to, hover, mouse_down, wait(60-120), mouse_up]
- `search_input`: [query_selector(input), char_input(k[0]), char_input(k[1]), ...]
- `search_click`: [query_selector(button/文本), move_to, hover, click, wait(800-1600)]
- `browse_list`: [query_selector(首项候选，含动态等待), move_to, hover, click, wait]
- `open_item` 降级： [program_click, wait] 或 [mouse_down(clickCount=2), wait, mouse_up]
- `browse_detail`: [scroll_by(+480)×N, wait×N, next_image(拆成 move/hover/click 或键盘事件)]
- `back_to_list`: [program_back 或 query_selector(返回按钮)+move/click]
- `open_next_item`: [query_selector(未访问项), move_to, hover, click, wait]

## IPC 与选择器覆盖
- 接收：`autoop-next`、`autoop-retry`、`autoop-error`、`autoop-set-selector(stage, selector)`。
- 发送：`autoop-plan-preview`（下一微动作预告）、`autoop-step-log`（结构化日志）、`autoop-debug-report`（错误现场）。
- 选择器应用：覆盖仅影响“后续”的解析类动作，不改变已解析出的坐标。

## 浮窗层级与交互
- 浮窗 `#autoop-floater` 保持高 `z-index`，始终最上层；拖拽与位置记忆已启用。
- 仅“下一步”才推进一个微动作；“重试”同步重复；“出错”保留现场并不前进。
- 计划预览显示“阶段/动作/选择器”，输入框应用到当前阶段。

## 日志与验证
- 每次“下一步”执行后输出结构化日志：`ts/runId/url/stage/microAction/selector/coords/result/error/elapsedMs`。
- 验证：启动后无自动动作；逐次点击推进；应用选择器后解析类动作优先使用你的选择器；报错采集现场并停留在当前步。

## 交付步骤
1) 重构 `src/main.js` 为队列驱动并移除自动化逻辑。
2) 保持 `src/preload.js` IPC 桥接（next/retry/error/setSelector/preview/log/report）。
3) `src/views/autoop.js` 保持仅初始化与浮窗控制，不触发任何自动动作。

请确认该方案，我将开始实施改造，确保“只有当你点击了才执行下一步操作”，并将步骤粒度限定到鼠标移动/悬停/点击/滚动/等待等最小单位。