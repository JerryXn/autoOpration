## 目标
- 基于你提供的 SVG 结构，确保在详情页稳定执行点赞与收藏：优先使用 `use[xlink\:href="#like"]` 与 `use[xlink\:href="#collect"]`，点击其父按钮并进行可靠的状态校验和必要的回退。

## 选择器与优先级
- 在配置 `detail_ui` 中新增/优先排列：
  - 点赞：`use[xlink\:href="#like"]`, `svg.reds-icon.like-icon`, `.like-lottie`, `button:has(.like-lottie)`, `.like-wrapper`, `[aria-label*="赞"]`, `button:has-text("赞")`, `button[aria-pressed]`
  - 收藏：`use[xlink\:href="#collect"]`, `svg.reds-icon.collect-icon`, `.collect-icon`, `button:has(.collect-icon)`, `[aria-label*="收藏"]`, `button:has-text("收藏")`, `button[aria-pressed]`
- 代码优先使用配置数组，便于后续仅通过配置适配页面变动。

## 点击策略
- 对每个候选选择器执行：
  1. 显式等待（~2s）：`wait_for_selector`；如出现则继续。
  2. 取元素详情并打印：`is_visible`、`is_enabled`、`bounding_box`、`inner_text`（截断），帮助定位匹配效果。
  3. 点击流程：
     - 若是 `use[xlink\:href]` 或 `svg`，先 `closest('button')`，否则点击元素本身；前置 `scroll_into_view_if_needed`。
  4. 回退一：DOM 事件分发（`dispatchEvent('click')`），明确打印回退策略。
  5. 回退二：坐标点击（`bounding_box` 中心点），打印坐标与是否成功。

## 成功判定与归一化
- 计数策略：点击前后尝试读取计数（不可用时为 `None`）。
- 属性/类名策略：
  - 点赞：`aria-pressed == true` 或类名含 `liked`。
  - 收藏：`aria-pressed == true` 或类名含 `collected`。
- 归一化：若计数无效但属性选中态为真，则统一为 `ok`。

## 触发与健壮性
- 在详情页循环中，动作始终尝试（受 `--like/--fav` 与 `dry_run` 控制），异常记录但不阻塞后续；保留门槛与结果打印：`like_gate/collect_gate`、`like_done/collect_done`。

## 日志输出（仅动作相关，便于判断）
- 选择器列表：`like_selectors` / `collect_selectors`
- 逐条计数：`like_probe_item` / `collect_probe_item`
- 命中详情：`like_found` / `collect_found`（包含 visible/enabled/bbox/text 摘要）
- 回退策略：`like_fallback` / `collect_fallback`
- 选中态属性：`like_attr` / `collect_attr`
- 结果摘要：`like_done` / `collect_done`（包含 status/before/after/selected）

## 验证与测试
- 更新测试：在测试中加入 `use[xlink\:href]` 选择器覆盖与回退逻辑断言。
- 手动验证命令：
  - 不写库：`MYSQL_DATABASE=auto_test python -m auto_opration_python.src.main_xhs --like --fav --keyword=哈哈`
  - 写库：`MYSQL_DATABASE=auto_final MYSQL_HOST=127.0.0.1 MYSQL_PORT=3306 MYSQL_USER=root MYSQL_PASSWORD=yourpass python -m auto_opration_python.src.main_xhs --like --fav --record --userId=1 --keyword=哈哈`

## 交付
- 修改配置与实现，补充测试，保证在你提供的 SVG 结构下点赞与收藏稳定执行，并在终端提供足够但不冗余的动作日志以辅助判断。