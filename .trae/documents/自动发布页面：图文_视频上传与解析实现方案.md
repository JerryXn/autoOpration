## 功能概述
- 自动发布入口，含两个操作：`上传图文`、`上传视频`，受功能码控制（建议新增 `publish_image_text`、`publish_video`；admin 全开）。
- 两种数据来源：`Excel上传` 与 `飞书公开链接上传`，解析后统一生成并展示可校验的表格。
- 点击“确认”进行严格校验：Excel 中 `封面`、`配图` 与用户上传图片文件名一致性检查；不一致阻断并提示明细。

## 前端页面与交互（src/index.html, src/renderer.js）
- 在平台操作页新增“自动发布”卡片，进入后显示：
  - 顶部单选：`Excel上传` / `飞书链接上传`。
  - Excel上传：
    - 按钮：`下载模板(.xlsx)`；生成列 `主题`、`标题`、`文案`、`封面`、`配图`（多图用`,`分隔）。
    - 文件选择 A：选择 `.xlsx` 文件；解析后生成预览数据。
    - 文件选择 B：选择图片文件（多选）；支持拖拽；构建上传图片名集合。
  - 飞书链接上传：输入公开链接（最好含 `share_token`）；按回车加载隐藏窗口，抓取并解析数据。
- 预览表格：统一列展示；追加校验列 `封面匹配状态`、`配图匹配状态`；悬停显示图片缩略图。
- 操作按钮：`确认`（触发校验并阻断不一致）、`导出(.xlsx)`（导出解析与校验结果）。

## 解析与校验逻辑
- Excel解析：
  - 使用 `xlsx` 读取工作表，映射列到标准字段；`封面/配图` 字段按`,`分隔为数组，去空格与空项。
- 图片名提取：
  - 对 Excel 中每个图片标识，若为 URL，取 basename（最后一段）参与匹配；统一大小写。
  - 上传图片集合：取文件名（不含路径），统一大小写。
- 行级校验：
  - 对每行的 `封面[]` 与 `配图[]` 与上传集合做包含检查；生成缺失列表。
  - 预览中标注缺失项并汇总统计；`确认` 时若存在缺失，弹出明细提示并阻断继续。
  - 汇总“未引用图片”（上传但未在任何行引用），非阻断，仅提示。

## 飞书链接解析
- 复用主进程已有 `feishu-fetch(url)` IPC（src/main.js, src/preload.js）；在隐藏窗口以桌面 UA 加载链接并返回 HTML。
- 渲染进程解析 DOM 或主进程解析后返回结构：列头/行数据；将 `封面/配图` 同样按`,`分割并支持 URL→basename。
- 若返回登录页/无公开权限，提示用户开启公开访问或使用含 `share_token` 的链接。

## 权限控制
- 后端已具备 `getPlatformFeatures`；前端根据功能码显示“上传图文/上传视频”选项；admin 无需授权全可见。

## 依赖与安全
- 新增前端依赖：`xlsx`（SheetJS）。
- 安全：不持久化外部图片与链接内容；仅本地预览；主进程窗口启用 `contextIsolation`、`sandbox`。

## 验证与测试
- 单测：Excel解析（逗号分割、URL→basename）、图片匹配（缺失/未引用）、必填字段校验。
- 集成：飞书链接公开/拦截分支；预览与导出一致性。
- 手测：用模板导入数据与图片，确认“确认”按钮拦截逻辑与提示内容准确。

## 里程碑
- 阶段 1：页面与权限接入、Excel解析与模板、图片匹配校验、预览与确认逻辑。
- 阶段 2：飞书链接解析与列映射、拦截与引导提示、导出功能完善。
- 阶段 3：体验优化（缩略图、筛选/排序）、性能与错误处理强化。

请确认：
- 功能码命名（`publish_image_text`、`publish_video`）是否采用；
- Excel 模板是否仅包含上述五列；
- 图片匹配以文件名为准（URL 使用 basename）的规则是否 OK。
确认后我将开始实施代码。