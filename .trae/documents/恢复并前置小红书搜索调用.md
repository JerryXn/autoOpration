## 问题定位
- 日志停留在 `paginate 开始 → db connect 信息`，后续 `search_notes` 没有出现，且进程被 SIGINT 中断。
- 现有入口在 curl 模式下先连接 DB 并准备存储，搜索请求靠后，导致没有及时看到搜索调用；并且缺少明确的 `search_notes begin` 日志。

## 恢复方案
### 1. 前置搜索调用
- 在 `cookie_built / search_keyword / comments_config` 之后，立即执行 curl 搜索：
  - `api.search_notes_with_body(...)`，超时 8s
  - 打印 `search_notes begin` / `search_notes ok` / `search_notes error`
- 将 DB 连接与写入移至“搜索结果解析之后”，仅在 `--record` 为真时执行。

### 2. 导航与回退
- 保持并显式 `goto_search`（`/explore`）；curl 缺失或返回空时：
  - 启动页面回退：滚动 + 等待 `/feed` 响应 + 采集 `a[href*="/explore/"]` 提取 `note_id` 列表
  - 打印 `search_notes_captured ok {count}` 并进入详情执行动作

### 3. 配置与标志
- 使用 `XHS_SEARCH_FILTERS_JSON` 解析筛选（noteType/sort/time/scope/distance），映射到 `search_notes_with_body` 的 body
- 确保 `cfg.xhs.pagination.enabled=true` 生效，page_start/page_size 从配置或 body 取值

### 4. DB 行为按需
- 仅在 `--record` 时：连接 DB → `create_tables` → `store_items`/`update_desc`/`replace_images`/`replace_tags`/`store_comments_page`
- 如果不记录，跳过所有 DB 写入，避免阻塞

### 5. 日志补充
- 新增：`api search_notes begin`、`api search_notes ok`、`api search_notes error`
- 保留：`goto_entry/goto_search`、`feed_desc`、动作链路 `like_* / collect_*`

### 6. 退出与保活
- 移除回退分支的无限保活；主流程完成后正常退出，避免看起来“卡住”

### 7. 验证
- 运行：`MYSQL_DATABASE=auto_test XHS_HEADLESS=false python -m auto_opration_python.src.main_xhs --like --fav --keyword=哈哈`
- 预期：出现 `search_notes begin → ok` 或 `captured ok count>0`，随后进入详情并执行点赞/收藏

## 涉及文件
- `auto_opration_python/src/main_xhs.py`：调整调用顺序，增加 begin/ok/error 日志，按需连接 DB，完善回退

## 备注
- 不改变现有 CLI 与环境变量；恢复并强化“先搜索后存储”的顺序，保证你在终端能看到明确的搜索调用与结果。